use windows::core::PCSTR;
use windows::Win32::Foundation::WPARAM;
use windows::Win32::Globalization::{WideCharToMultiByte, CP_UTF8};
use windows::Win32::UI::Input::KeyboardAndMouse::{
    GetKeyState, GetKeyboardLayout, MapVirtualKeyExW, ToUnicodeEx, VkKeyScanExA, MAPVK_VK_TO_VSC,
    MAPVK_VSC_TO_VK, VIRTUAL_KEY, VK_SHIFT,
};

use crate::Key;

pub fn translate_key(raw_key_code: WPARAM) -> Key {
    let key_code: u16 = match raw_key_code.0.try_into() {
        Ok(k) => k,
        Err(_) => return Key::Unidentified,
    };

    match VIRTUAL_KEY(key_code) {
        VK_0 => Key::Unidentified,
        VK_1 => Key::Unidentified,
        VK_2 => Key::Unidentified,
        VK_3 => Key::Unidentified,
        VK_4 => Key::Unidentified,
        VK_5 => Key::Unidentified,
        VK_6 => Key::Unidentified,
        VK_7 => Key::Unidentified,
        VK_8 => Key::Unidentified,
        VK_9 => Key::Unidentified,
        VK_A => Key::Unidentified,
        VK_B => Key::Unidentified,
        VK_C => Key::Unidentified,
        VK_D => Key::Unidentified,
        VK_E => Key::Unidentified,
        VK_F => Key::Unidentified,
        VK_G => Key::Unidentified,
        VK_H => Key::Unidentified,
        VK_I => Key::Unidentified,
        VK_J => Key::Unidentified,
        VK_K => Key::Unidentified,
        VK_L => Key::Unidentified,
        VK_M => Key::Unidentified,
        VK_N => Key::Unidentified,
        VK_O => Key::Unidentified,
        VK_P => Key::Unidentified,
        VK_Q => Key::Unidentified,
        VK_R => Key::Unidentified,
        VK_S => Key::Unidentified,
        VK_T => Key::Unidentified,
        VK_U => Key::Unidentified,
        VK_V => Key::Unidentified,
        VK_W => Key::Unidentified,
        VK_X => Key::Unidentified,
        VK_Y => Key::Unidentified,
        VK_Z => Key::Unidentified,

        VK_ABNT_C1 => Key::Unidentified,
        VK_ABNT_C2 => Key::Unidentified,
        VK_ACCEPT => Key::Unidentified,
        VK_ADD => Key::Unidentified,
        VK_APPS => Key::Unidentified,
        VK_ATTN => Key::Unidentified,
        VK_BACK => Key::Unidentified,
        VK_BROWSER_BACK => Key::Unidentified,
        VK_BROWSER_FAVORITES => Key::Unidentified,
        VK_BROWSER_FORWARD => Key::Unidentified,
        VK_BROWSER_HOME => Key::Unidentified,
        VK_BROWSER_REFRESH => Key::Unidentified,
        VK_BROWSER_SEARCH => Key::Unidentified,
        VK_BROWSER_STOP => Key::Unidentified,
        VK_CANCEL => Key::Unidentified,
        VK_CAPITAL => Key::Unidentified,
        VK_CLEAR => Key::Unidentified,
        VK_CONTROL => Key::Unidentified,
        VK_CONVERT => Key::Unidentified,
        VK_CRSEL => Key::Unidentified,
        VK_DBE_ALPHANUMERIC => Key::Unidentified,
        VK_DBE_CODEINPUT => Key::Unidentified,
        VK_DBE_DBCSCHAR => Key::Unidentified,
        VK_DBE_DETERMINESTRING => Key::Unidentified,
        VK_DBE_ENTERDLGCONVERSIONMODE => Key::Unidentified,
        VK_DBE_ENTERIMECONFIGMODE => Key::Unidentified,
        VK_DBE_ENTERWORDREGISTERMODE => Key::Unidentified,
        VK_DBE_FLUSHSTRING => Key::Unidentified,
        VK_DBE_HIRAGANA => Key::Unidentified,
        VK_DBE_KATAKANA => Key::Unidentified,
        VK_DBE_NOCODEINPUT => Key::Unidentified,
        VK_DBE_NOROMAN => Key::Unidentified,
        VK_DBE_ROMAN => Key::Unidentified,
        VK_DBE_SBCSCHAR => Key::Unidentified,
        VK_DECIMAL => Key::Unidentified,
        VK_DELETE => Key::Unidentified,
        VK_DIVIDE => Key::Unidentified,
        VK_DOWN => Key::Unidentified,
        VK_END => Key::Unidentified,
        VK_EREOF => Key::Unidentified,
        VK_ESCAPE => Key::Unidentified,
        VK_EXECUTE => Key::Unidentified,
        VK_EXSEL => Key::Unidentified,
        VK_F1 => Key::Unidentified,
        VK_F10 => Key::Unidentified,
        VK_F11 => Key::Unidentified,
        VK_F12 => Key::Unidentified,
        VK_F13 => Key::Unidentified,
        VK_F14 => Key::Unidentified,
        VK_F15 => Key::Unidentified,
        VK_F16 => Key::Unidentified,
        VK_F17 => Key::Unidentified,
        VK_F18 => Key::Unidentified,
        VK_F19 => Key::Unidentified,
        VK_F2 => Key::Unidentified,
        VK_F20 => Key::Unidentified,
        VK_F21 => Key::Unidentified,
        VK_F22 => Key::Unidentified,
        VK_F23 => Key::Unidentified,
        VK_F24 => Key::Unidentified,
        VK_F3 => Key::Unidentified,
        VK_F4 => Key::Unidentified,
        VK_F5 => Key::Unidentified,
        VK_F6 => Key::Unidentified,
        VK_F7 => Key::Unidentified,
        VK_F8 => Key::Unidentified,
        VK_F9 => Key::Unidentified,
        VK_FINAL => Key::Unidentified,
        VK_GAMEPAD_A => Key::Unidentified,
        VK_GAMEPAD_B => Key::Unidentified,
        VK_GAMEPAD_DPAD_DOWN => Key::Unidentified,
        VK_GAMEPAD_DPAD_LEFT => Key::Unidentified,
        VK_GAMEPAD_DPAD_RIGHT => Key::Unidentified,
        VK_GAMEPAD_DPAD_UP => Key::Unidentified,
        VK_GAMEPAD_LEFT_SHOULDER => Key::Unidentified,
        VK_GAMEPAD_LEFT_THUMBSTICK_BUTTON => Key::Unidentified,
        VK_GAMEPAD_LEFT_THUMBSTICK_DOWN => Key::Unidentified,
        VK_GAMEPAD_LEFT_THUMBSTICK_LEFT => Key::Unidentified,
        VK_GAMEPAD_LEFT_THUMBSTICK_RIGHT => Key::Unidentified,
        VK_GAMEPAD_LEFT_THUMBSTICK_UP => Key::Unidentified,
        VK_GAMEPAD_LEFT_TRIGGER => Key::Unidentified,
        VK_GAMEPAD_MENU => Key::Unidentified,
        VK_GAMEPAD_RIGHT_SHOULDER => Key::Unidentified,
        VK_GAMEPAD_RIGHT_THUMBSTICK_BUTTON => Key::Unidentified,
        VK_GAMEPAD_RIGHT_THUMBSTICK_DOWN => Key::Unidentified,
        VK_GAMEPAD_RIGHT_THUMBSTICK_LEFT => Key::Unidentified,
        VK_GAMEPAD_RIGHT_THUMBSTICK_RIGHT => Key::Unidentified,
        VK_GAMEPAD_RIGHT_THUMBSTICK_UP => Key::Unidentified,
        VK_GAMEPAD_RIGHT_TRIGGER => Key::Unidentified,
        VK_GAMEPAD_VIEW => Key::Unidentified,
        VK_GAMEPAD_X => Key::Unidentified,
        VK_GAMEPAD_Y => Key::Unidentified,
        VK_HANGEUL => Key::Unidentified,
        VK_HANGUL => Key::Unidentified,
        VK_HANJA => Key::Unidentified,
        VK_HELP => Key::Unidentified,
        VK_HOME => Key::Unidentified,
        VK_ICO_00 => Key::Unidentified,
        VK_ICO_CLEAR => Key::Unidentified,
        VK_ICO_HELP => Key::Unidentified,
        VK_IME_OFF => Key::Unidentified,
        VK_IME_ON => Key::Unidentified,
        VK_INSERT => Key::Unidentified,
        VK_JUNJA => Key::Unidentified,
        VK_KANA => Key::Unidentified,
        VK_KANJI => Key::Unidentified,
        VK_LAUNCH_APP1 => Key::Unidentified,
        VK_LAUNCH_APP2 => Key::Unidentified,
        VK_LAUNCH_MAIL => Key::Unidentified,
        VK_LAUNCH_MEDIA_SELECT => Key::Unidentified,
        VK_LBUTTON => Key::Unidentified,
        VK_LCONTROL => Key::Unidentified,
        VK_LEFT => Key::Unidentified,
        VK_LMENU => Key::Unidentified,
        VK_LSHIFT => Key::Unidentified,
        VK_LWIN => Key::Unidentified,
        VK_MBUTTON => Key::Unidentified,
        VK_MEDIA_NEXT_TRACK => Key::Unidentified,
        VK_MEDIA_PLAY_PAUSE => Key::Unidentified,
        VK_MEDIA_PREV_TRACK => Key::Unidentified,
        VK_MEDIA_STOP => Key::Unidentified,
        VK_MENU => Key::Unidentified,
        VK_MODECHANGE => Key::Unidentified,
        VK_MULTIPLY => Key::Unidentified,
        VK_NAVIGATION_ACCEPT => Key::Unidentified,
        VK_NAVIGATION_CANCEL => Key::Unidentified,
        VK_NAVIGATION_DOWN => Key::Unidentified,
        VK_NAVIGATION_LEFT => Key::Unidentified,
        VK_NAVIGATION_MENU => Key::Unidentified,
        VK_NAVIGATION_RIGHT => Key::Unidentified,
        VK_NAVIGATION_UP => Key::Unidentified,
        VK_NAVIGATION_VIEW => Key::Unidentified,
        VK_NEXT => Key::Unidentified,
        VK_NONAME => Key::Unidentified,
        VK_NONCONVERT => Key::Unidentified,
        VK_NUMLOCK => Key::Unidentified,
        VK_NUMPAD0 => Key::Unidentified,
        VK_NUMPAD1 => Key::Unidentified,
        VK_NUMPAD2 => Key::Unidentified,
        VK_NUMPAD3 => Key::Unidentified,
        VK_NUMPAD4 => Key::Unidentified,
        VK_NUMPAD5 => Key::Unidentified,
        VK_NUMPAD6 => Key::Unidentified,
        VK_NUMPAD7 => Key::Unidentified,
        VK_NUMPAD8 => Key::Unidentified,
        VK_NUMPAD9 => Key::Unidentified,
        VK_OEM_1 => Key::Unidentified,
        VK_OEM_102 => Key::Unidentified,
        VK_OEM_2 => Key::Unidentified,
        VK_OEM_3 => Key::Unidentified,
        VK_OEM_4 => Key::Unidentified,
        VK_OEM_5 => Key::Unidentified,
        VK_OEM_6 => Key::Unidentified,
        VK_OEM_7 => Key::Unidentified,
        VK_OEM_8 => Key::Unidentified,
        VK_OEM_ATTN => Key::Unidentified,
        VK_OEM_AUTO => Key::Unidentified,
        VK_OEM_AX => Key::Unidentified,
        VK_OEM_BACKTAB => Key::Unidentified,
        VK_OEM_CLEAR => Key::Unidentified,
        VK_OEM_COMMA => Key::Unidentified,
        VK_OEM_COPY => Key::Unidentified,
        VK_OEM_CUSEL => Key::Unidentified,
        VK_OEM_ENLW => Key::Unidentified,
        VK_OEM_FINISH => Key::Unidentified,
        VK_OEM_FJ_JISHO => Key::Unidentified,
        VK_OEM_FJ_LOYA => Key::Unidentified,
        VK_OEM_FJ_MASSHOU => Key::Unidentified,
        VK_OEM_FJ_ROYA => Key::Unidentified,
        VK_OEM_FJ_TOUROKU => Key::Unidentified,
        VK_OEM_JUMP => Key::Unidentified,
        VK_OEM_MINUS => Key::Unidentified,
        VK_OEM_NEC_EQUAL => Key::Unidentified,
        VK_OEM_PA1 => Key::Unidentified,
        VK_OEM_PA2 => Key::Unidentified,
        VK_OEM_PA3 => Key::Unidentified,
        VK_OEM_PERIOD => Key::Unidentified,
        VK_OEM_PLUS => Key::Unidentified,
        VK_OEM_RESET => Key::Unidentified,
        VK_OEM_WSCTRL => Key::Unidentified,
        VK_PA1 => Key::Unidentified,
        VK_PACKET => Key::Unidentified,
        VK_PAUSE => Key::Unidentified,
        VK_PLAY => Key::Unidentified,
        VK_PRINT => Key::Unidentified,
        VK_PRIOR => Key::Unidentified,
        VK_PROCESSKEY => Key::Unidentified,
        VK_RBUTTON => Key::Unidentified,
        VK_RCONTROL => Key::Unidentified,
        VK_RETURN => Key::Unidentified,
        VK_RIGHT => Key::Unidentified,
        VK_RMENU => Key::Unidentified,
        VK_RSHIFT => Key::Unidentified,
        VK_RWIN => Key::Unidentified,
        VK_SCROLL => Key::Unidentified,
        VK_SELECT => Key::Unidentified,
        VK_SEPARATOR => Key::Unidentified,
        VK_SHIFT => Key::Unidentified,
        VK_SLEEP => Key::Unidentified,
        VK_SNAPSHOT => Key::Unidentified,
        VK_SPACE => Key::Unidentified,
        VK_SUBTRACT => Key::Unidentified,
        VK_TAB => Key::Unidentified,
        VK_UP => Key::Unidentified,
        VK_VOLUME_DOWN => Key::Unidentified,
        VK_VOLUME_MUTE => Key::Unidentified,
        VK_VOLUME_UP => Key::Unidentified,
        VK_XBUTTON1 => Key::Unidentified,
        VK_XBUTTON2 => Key::Unidentified,
        VK_ZOOM => Key::Unidentified,
        VK__none_ => Key::Unidentified,
        _ => Key::Unidentified,
    }
}
